<div class="card shadow-lg border-0 rounded-xl">
  <div class="card-header bg-primary text-white text-xl font-semibold p-4">Registro Actual</div>

  <div class="card-body p-4">
    <!-- ðŸ” BARRA DE BÃšSQUEDA -->
    <div class="input-group mb-3 flex flex-col sm:flex-row gap-2">
      <input
        type="text"
        class="form-control"
        placeholder="Buscar por RUC o razÃ³n social"
        [(ngModel)]="busqueda"
        (keyup.enter)="buscar()"
        name="searchQuery"
      />
      <button class="btn btn-primary" (click)="buscar()" [disabled]="loading()">
        <span *ngIf="!loading()">Buscar</span>
        <span *ngIf="loading()"> <i class="spinner-border spinner-border-sm me-1"></i> Cargando... </span>
      </button>
    </div>

    <!-- â³ CARGA INICIAL -->
    <div *ngIf="loading() && itemsFiltrados().length === 0" class="alert alert-info text-center">Cargando resultados...</div>

    <!-- ðŸ“‹ TABLA -->
    <table
      *ngIf="itemsFiltrados().length > 0"
      class="table table-striped table-hover table-responsive mt-3 border rounded-lg overflow-hidden"
    >
      <thead>
        <tr class="table-dark">
          <th>RUC</th>
          <th>DV</th>
          <th>RAZON SOCIAL</th>
          <th>TIPO</th>
          <th>NRO. TRAMITE</th>
          <th>COMUNICACIÃ“N</th>
          <th>FECHA DE COMUNICACIÃ“N</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of itemsFiltrados()">
          <td>{{ item.ruc }}</td>
          <td>{{ item.dv }}</td>
          <td>{{ item.razonSocial }}</td>
          <td>{{ item.tipo }}</td>
          <td>{{ item.tramiteId }}</td>
          <td>{{ item.tipoComunicacion }}</td>
          <td>{{ item.fechaComunicacion | date: 'short' }}</td>
        </tr>
      </tbody>
    </table>

    <!-- ðŸ“Š INFO DE RESULTADOS -->
    <div *ngIf="totalItems() > 0" class="text-muted text-sm my-3">
      PÃ¡gina {{ page + 1 }} â€“ Mostrando {{ itemsFiltrados().length }} de {{ totalItems() }} registros
    </div>

    <!-- ðŸ”¢ PAGINACIÃ“N REAL -->
    <nav *ngIf="totalItems() > size" class="d-flex justify-content-center">
      <ul class="pagination">
        <!-- â—€ ANTERIOR -->
        <li class="page-item" [class.disabled]="page === 0">
          <button class="page-link" (click)="loadPage(page - 1)" [disabled]="page === 0">Anterior</button>
        </li>

        <!-- ðŸ“„ NÃšMEROS DE PÃGINA -->
        <li class="page-item" *ngFor="let p of getPages()" [class.active]="p === page">
          <button class="page-link" (click)="loadPage(p)">
            {{ p + 1 }}
          </button>
        </li>

        <!-- â–¶ SIGUIENTE -->
        <li class="page-item" [class.disabled]="page + 1 >= Math.ceil(totalItems() / size)">
          <button class="page-link" (click)="loadPage(page + 1)" [disabled]="page + 1 >= Math.ceil(totalItems() / size)">Siguiente</button>
        </li>
      </ul>
    </nav>

    <!-- ðŸ“¤ EXPORTACIONES -->
    <div class="mt-3">
      <button class="btn btn-success me-2" (click)="exportToExcel()"><i class="fa fa-file-excel"></i> Exportar pÃ¡gina actual</button>
      <button class="btn btn-success" (click)="exportToExcelAll()">Exportar TODO</button>
    </div>

    <!-- âš  SIN RESULTADOS -->
    <div *ngIf="!loading() && itemsFiltrados().length === 0" class="alert alert-warning text-center mt-3">
      No se encontraron datos para la bÃºsqueda actual.
    </div>
  </div>
</div>
